---
title: Risolvere i problemi principali di ASP.NET in IIS
author: guardrex
description: Come diagnosticare i problemi con le distribuzioni di IIS di App ASP.NET Core.
manager: wpickett
ms.author: riande
ms.custom: mvc
ms.date: 03/13/2017
ms.prod: asp.net-core
ms.technology: aspnet
ms.topic: article
uid: host-and-deploy/iis/troubleshoot
ms.openlocfilehash: c68070a9cba5667504d1ad4927b02b73f83e6573
ms.sourcegitcommit: a510f38930abc84c4b302029d019a34dfe76823b
ms.translationtype: MT
ms.contentlocale: it-IT
ms.lasthandoff: 01/30/2018
---
# <a name="troubleshoot-aspnet-core-on-iis"></a><span data-ttu-id="6bc15-103">Risolvere i problemi principali di ASP.NET in IIS</span><span class="sxs-lookup"><span data-stu-id="6bc15-103">Troubleshoot ASP.NET Core on IIS</span></span>

<span data-ttu-id="6bc15-104">Di [Luke Latham](https://github.com/guardrex)</span><span class="sxs-lookup"><span data-stu-id="6bc15-104">By [Luke Latham](https://github.com/guardrex)</span></span>

<span data-ttu-id="6bc15-105">Per diagnosticare i problemi relativi alle distribuzioni di IIS:</span><span class="sxs-lookup"><span data-stu-id="6bc15-105">To diagnose issues with IIS deployments:</span></span>

* <span data-ttu-id="6bc15-106">Esaminare l'output del browser.</span><span class="sxs-lookup"><span data-stu-id="6bc15-106">Study browser output.</span></span>
* <span data-ttu-id="6bc15-107">Esaminare il **registro applicazioni** del sistema con il **Visualizzatore eventi**.</span><span class="sxs-lookup"><span data-stu-id="6bc15-107">Examine the system's **Application** log through **Event Viewer**.</span></span>
* <span data-ttu-id="6bc15-108">Abilitare la registrazione `stdout`.</span><span class="sxs-lookup"><span data-stu-id="6bc15-108">Enable `stdout` logging.</span></span> <span data-ttu-id="6bc15-109">Il registro **Modulo ASP.NET Core** si trova nel percorso specificato nell'attributo *stdoutLogFile* dell'elemento `<aspNetCore>` in *web.config*. Le cartelle nel percorso fornito nel valore dell'attributo devono essere presenti nella distribuzione.</span><span class="sxs-lookup"><span data-stu-id="6bc15-109">The **ASP.NET Core Module** log is found on the path provided in the *stdoutLogFile* attribute of the `<aspNetCore>` element in *web.config*. Any folders on the path provided in the attribute value must exist in the deployment.</span></span> <span data-ttu-id="6bc15-110">Impostare *stdoutLogEnabled* a `true`.</span><span class="sxs-lookup"><span data-stu-id="6bc15-110">Set *stdoutLogEnabled* to `true`.</span></span> <span data-ttu-id="6bc15-111">App che usano l'il `Microsoft.NET.Sdk.Web` SDK per creare il *Web. config* file predefinito di *stdoutLogEnabled* impostando su `false`manualmente forniscono il *Web. config* file o modificare il file per permettere `stdout` registrazione.</span><span class="sxs-lookup"><span data-stu-id="6bc15-111">Apps that use the the `Microsoft.NET.Sdk.Web` SDK to create the *web.config* file default the *stdoutLogEnabled* setting to `false`, so manually provide the *web.config* file or modify the file in order to enable `stdout` logging.</span></span>

<span data-ttu-id="6bc15-112">Informazioni utilizzate da tali tre origini con il [argomento fanno riferimento a errori comuni](xref:host-and-deploy/azure-iis-errors-reference) per determinare il problema.</span><span class="sxs-lookup"><span data-stu-id="6bc15-112">Use information from those three sources with the [common errors reference topic](xref:host-and-deploy/azure-iis-errors-reference) to determine the problem.</span></span> <span data-ttu-id="6bc15-113">Seguire i consigli sulla risoluzione dei problemi forniti per risolvere il problema.</span><span class="sxs-lookup"><span data-stu-id="6bc15-113">Follow the troubleshooting advice provided to resolve the issue.</span></span>

<span data-ttu-id="6bc15-114">Molti errori comuni non vengono visualizzati nel browser, nel registro applicazioni e nel registro del modulo ASP.NET Core fino a quando non vengono superate le impostazioni *startupTimeLimit* (impostazione predefinita: 120 secondi) e *startupRetryCount* (impostazione predefinita: 2) del modulo.</span><span class="sxs-lookup"><span data-stu-id="6bc15-114">Several of the common errors don't appear in the browser, Application Log, and ASP.NET Core Module Log until the module *startupTimeLimit* (default: 120 seconds) and *startupRetryCount* (default: 2) have passed.</span></span> <span data-ttu-id="6bc15-115">Attendere almeno sei minuti prima di dedurre che il modulo non è riuscito ad avviare un processo per l'applicazione.</span><span class="sxs-lookup"><span data-stu-id="6bc15-115">Therefore, wait a full six minutes before deducing that the module has failed to start a process for the app.</span></span>

<span data-ttu-id="6bc15-116">Un modo veloce per determinare se l'app funziona correttamente è l'esecuzione dell'app direttamente su Kestrel.</span><span class="sxs-lookup"><span data-stu-id="6bc15-116">One quick way to determine if the app is working properly is to run the app directly on Kestrel.</span></span> <span data-ttu-id="6bc15-117">Se l'app è stato pubblicato come un [framework dipendente distribuzione](/dotnet/core/deploying/#framework-dependent-deployments-fdd), eseguire `dotnet <assembly_name>.dll` nella cartella di distribuzione, ovvero il percorso fisico di IIS per l'app.</span><span class="sxs-lookup"><span data-stu-id="6bc15-117">If the app was published as a [framework-dependent deployment](/dotnet/core/deploying/#framework-dependent-deployments-fdd), execute `dotnet <assembly_name>.dll` in the deployment folder, which is the IIS physical path to the app.</span></span> <span data-ttu-id="6bc15-118">Se l'app è stato pubblicato come un [distribuzione indipendente](/dotnet/core/deploying/#self-contained-deployments-scd), eseguire l'app dell'eseguibile direttamente da un prompt dei comandi, `<assembly_name>.exe`, nella cartella di distribuzione.</span><span class="sxs-lookup"><span data-stu-id="6bc15-118">If the app was published as a [self-contained deployment](/dotnet/core/deploying/#self-contained-deployments-scd), run the app's executable directly from a command prompt, `<assembly_name>.exe`, in the deployment folder.</span></span> <span data-ttu-id="6bc15-119">Se è in ascolto sulla porta predefinita 5000 Kestrel, l'app deve essere disponibile all'indirizzo `http://localhost:5000/`.</span><span class="sxs-lookup"><span data-stu-id="6bc15-119">If Kestrel is listening on default port 5000, the app should be available at `http://localhost:5000/`.</span></span> <span data-ttu-id="6bc15-120">Se l'applicazione risponde in genere in corrispondenza dell'indirizzo endpoint Kestrel, il problema è probabilmente correlate alla configurazione del proxy inverso e meno probabile che all'interno dell'app.</span><span class="sxs-lookup"><span data-stu-id="6bc15-120">If the app responds normally at the Kestrel endpoint address, the problem is more likely related to the reverse proxy configuration and less likely within the app.</span></span>

<span data-ttu-id="6bc15-121">È un modo per determinare se il proxy inverso funziona correttamente per eseguire una richiesta semplice file statici per un foglio di stile, script o l'immagine dal file dell'app in *wwwroot* utilizzando [Middleware File statici](xref:fundamentals/static-files).</span><span class="sxs-lookup"><span data-stu-id="6bc15-121">One way to determine if the reverse proxy is working properly is to perform a simple static file request for a stylesheet, script, or image from the app's static files in *wwwroot* using [Static File Middleware](xref:fundamentals/static-files).</span></span> <span data-ttu-id="6bc15-122">Se l'app può essere utilizzato un file statico, ma le visualizzazioni MVC e altri endpoint hanno esito negativo, il problema è meno probabile che correlati alla configurazione del proxy inverso e più probabile che all'interno dell'app (ad esempio, il routing MVC o 500 Internal Server Error).</span><span class="sxs-lookup"><span data-stu-id="6bc15-122">If the app can serve static files but MVC Views and other endpoints are failing, the problem is less likely related to the reverse proxy configuration and more likely within the app (for example, MVC routing or 500 Internal Server Error).</span></span>

<span data-ttu-id="6bc15-123">Quando viene avviato normalmente Kestrel dietro IIS, ma l'app non viene eseguito nel sistema dopo aver correttamente eseguito localmente, è possibile aggiungere temporaneamente una variabile di ambiente per *Web. config* per impostare il `ASPNETCORE_ENVIRONMENT` a `Development`.</span><span class="sxs-lookup"><span data-stu-id="6bc15-123">When Kestrel starts normally behind IIS but the app won't run on the system after successfully running locally, an environment variable can be temporarily added to *web.config* to set the `ASPNETCORE_ENVIRONMENT` to `Development`.</span></span> <span data-ttu-id="6bc15-124">Variabile di ambiente consente fino a quando l'ambiente non è sottoposto a override in avvio dell'app, il [pagina eccezione developer](xref:fundamentals/error-handling) da visualizzare quando si esegue l'app.</span><span class="sxs-lookup"><span data-stu-id="6bc15-124">As long as the environment isn't overridden in app startup, setting the environment variable allows the [developer exception page](xref:fundamentals/error-handling) to appear when the app is run.</span></span> <span data-ttu-id="6bc15-125">Variabile di ambiente per `ASPNETCORE_ENVIRONMENT` in questo modo è consigliata solo per i server di gestione temporanea e il test non sono esposti a Internet.</span><span class="sxs-lookup"><span data-stu-id="6bc15-125">Setting the environment variable for `ASPNETCORE_ENVIRONMENT` in this way is only recommended for staging/testing servers that aren't exposed to the Internet.</span></span> <span data-ttu-id="6bc15-126">Assicurarsi di rimuovere la variabile di ambiente dal *Web. config* al termine del file.</span><span class="sxs-lookup"><span data-stu-id="6bc15-126">Be sure to remove the environment variable from the *web.config* file when finished.</span></span> <span data-ttu-id="6bc15-127">Per informazioni sull'impostazione delle variabili di ambiente tramite *Web. config*, vedere [elemento figlio environmentVariables di aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span><span class="sxs-lookup"><span data-stu-id="6bc15-127">For information on setting environment variables via *web.config*, see [environmentVariables child element of aspNetCore](xref:host-and-deploy/aspnet-core-module#setting-environment-variables).</span></span>

<span data-ttu-id="6bc15-128">Nella maggior parte dei casi l'abilitazione della registrazione dell'applicazione è utile per risolvere i problemi dell'applicazione o del proxy inverso.</span><span class="sxs-lookup"><span data-stu-id="6bc15-128">In most cases, enabling application logging assists in troubleshooting problems with the app or the reverse proxy.</span></span> <span data-ttu-id="6bc15-129">Per altre informazioni, vedere [Registrazione](xref:fundamentals/logging/index).</span><span class="sxs-lookup"><span data-stu-id="6bc15-129">See [Logging](xref:fundamentals/logging/index) for more information.</span></span>

<span data-ttu-id="6bc15-130">L'ultimo suggerimento di risoluzione dei problemi relativo alle App che non vengono eseguiti dopo l'aggiornamento di .NET Core SDK nelle versioni di computer o un pacchetto di sviluppo all'interno dell'app.</span><span class="sxs-lookup"><span data-stu-id="6bc15-130">The last troubleshooting tip pertains to apps that fail to run after upgrading either the .NET Core SDK on the development machine or package versions within the app.</span></span> <span data-ttu-id="6bc15-131">In alcuni casi i pacchetti incoerenti possono interrompere un'app quando si eseguono aggiornamenti principali.</span><span class="sxs-lookup"><span data-stu-id="6bc15-131">In some cases, incoherent packages may break an app when performing major upgrades.</span></span> <span data-ttu-id="6bc15-132">La maggior parte di questi problemi possono essere risolti automaticamente:</span><span class="sxs-lookup"><span data-stu-id="6bc15-132">Most of these issues can be fixed by:</span></span>

* <span data-ttu-id="6bc15-133">L'eliminazione di `bin` e `obj` cartelle nel progetto.</span><span class="sxs-lookup"><span data-stu-id="6bc15-133">Deleting the `bin` and `obj` folders in the project.</span></span>
* <span data-ttu-id="6bc15-134">Memorizza nella cache il pacchetto di cancellazione in `%UserProfile%\.nuget\packages\` e `%LocalAppData%\Nuget\v3-cache`.</span><span class="sxs-lookup"><span data-stu-id="6bc15-134">Clearing package caches at `%UserProfile%\.nuget\packages\` and `%LocalAppData%\Nuget\v3-cache`.</span></span>
* <span data-ttu-id="6bc15-135">Il ripristino e ricompilare il progetto.</span><span class="sxs-lookup"><span data-stu-id="6bc15-135">Restoring and rebuilding the project.</span></span>
* <span data-ttu-id="6bc15-136">Conferma che nel server di distribuzione precedente è stato completamente eliminata prima di distribuire nuovamente l'app.</span><span class="sxs-lookup"><span data-stu-id="6bc15-136">Confirming that the prior deployment on the server has been completely deleted prior to re-deploying the app.</span></span>

> [!TIP]
> <span data-ttu-id="6bc15-137">Un modo pratico per cancellare le cache pacchetto consiste nell'eseguire `dotnet nuget locals all --clear` da un prompt dei comandi.</span><span class="sxs-lookup"><span data-stu-id="6bc15-137">A convenient way to clear package caches is to execute `dotnet nuget locals all --clear` from a command prompt.</span></span>
> 
> <span data-ttu-id="6bc15-138">Cancellazione delle cache dei pacchetti possono inoltre essere eseguita utilizzando il [nuget.exe](https://www.nuget.org/downloads) strumento e l'esecuzione del comando `nuget locals all -clear`.</span><span class="sxs-lookup"><span data-stu-id="6bc15-138">Clearing package caches can also be accomplished by using the [nuget.exe](https://www.nuget.org/downloads) tool and executing the command `nuget locals all -clear`.</span></span> <span data-ttu-id="6bc15-139">*NuGet.exe* non è un'installazione in dotazione con Windows 10 e deve essere ottenuto separatamente dal sito Web NuGet.</span><span class="sxs-lookup"><span data-stu-id="6bc15-139">*nuget.exe* isn't a bundled install with Windows 10 and must be obtained separately from the NuGet website.</span></span>
<!--
> [!TIP]
> A convenient way to clear package caches is to:
>
> * Obtain the *NuGet.exe* tool from [NuGet.org](https://www.nuget.org/).
> * Add the path to *NuGet.exe* to the system PATH.
> * Execute `nuget locals all -clear` from a command prompt.
>
> Alternatively, execute `dotnet nuget locals all --clear` from a command prompt without obtaining *NuGet.exe*. -->

## <a name="additional-resources"></a><span data-ttu-id="6bc15-140">Risorse aggiuntive</span><span class="sxs-lookup"><span data-stu-id="6bc15-140">Additional resources</span></span>

* [<span data-ttu-id="6bc15-141">Errori comuni di Azure App Service e IIS con ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="6bc15-141">Common errors reference for Azure App Service and IIS with ASP.NET Core</span></span>](xref:host-and-deploy/azure-iis-errors-reference)
* [<span data-ttu-id="6bc15-142">Guida di riferimento per la configurazione del modulo ASP.NET Core</span><span class="sxs-lookup"><span data-stu-id="6bc15-142">ASP.NET Core Module configuration reference</span></span>](xref:host-and-deploy/aspnet-core-module)
